pull_request_rules:
{% if cookiecutter.integration_level|int >= 4 %}
- name: integration branch
  actions:
    merge:
      method: rebase
      rebase_fallback: merge
      strict: false
    delete_head_branch: {}
  conditions:
    - base=integration
    - -merged
    - -closed
    - label!=no-mergify
    - status-success=pr ready to merge
    - status-success=license/cla
{% if cookiecutter.repo != 'mfext' and cookiecutter.repo != 'testrepo' %}
    - status-success=continuous-integration/drone/pr
{% endif %}
{% else %}
- name: master branch
  actions:
    merge:
      method: rebase
      rebase_fallback: merge
      strict: false
    delete_head_branch: {}
  conditions:
    - base=master
    - -merged
    - -closed
    - label!=no-mergify
    - status-success=continuous-integration/drone/pr
    - '#approved-reviews-by>=1'
- name: master branch forced
  actions:
    merge:
      method: rebase
      rebase_fallback: merge
      strict: false
    delete_head_branch: {}
  conditions:
    - base=master
    - -merged
    - -closed
    - label!=no-mergify
    - label=Merge Now
{% endif %}
